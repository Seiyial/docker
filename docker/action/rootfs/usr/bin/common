#!/usr/bin/env bash

set -e

#
# Common variables
#

export REPOSITORY_NAME="$(echo ${GITHUB_REPOSITORY} | awk -F'/' '{print $2}')"
export REPOSITORY_FULLNAME="${GITHUB_REPOSITORY}"
export INPUT_VERSION="${INPUT_TAG}"

if [ "${INPUT_VERSION:0:1}" == "v" ]; then
    export INPUT_VERSION="${INPUT_TAG:1}"
else
    export INPUT_VERSION="${INPUT_TAG}"
fi

export IMAGE_BASE="${REPOSITORY_FULLNAME}:base-${INPUT_KIND}-${INPUT_BASE}"
export IMAGE_NAME="${REPOSITORY_FULLNAME}:${INPUT_VERSION}-${INPUT_KIND}"
export IMAGE_CONTEXT="./releases/${REPOSITORY_NAME}-${INPUT_VERSION}/"
export IMAGE_PATH="${IMAGE_CONTEXT}/docker/${INPUT_KIND}/Dockerfile"
